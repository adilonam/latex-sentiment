<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1498" height="1235"><desc>title%20Chatbot%20Service%20Sequence%20Diagram%0A%0Aparticipant%20Client%0Aparticipant%20FastAPI%0Aparticipant%20MongodbLoader%0Aparticipant%20HuggingFaceEmbeddings%0Aparticipant%20FAISS%0Aparticipant%20HuggingFacePipeline%0A%0AClient%20-%3E%20FastAPI%3A%20POST%20%2Fv1%2F%0Anote%20right%20of%20FastAPI%3A%20Receives%20chat%20question%0A%0AFastAPI%20-%3E%20FastAPI%3A%20print(%22processing%20...%22)%0A%0AFastAPI%20-%3E%20MongodbLoader%3A%20aload()%0AMongodbLoader%20-%3E%20MongodbLoader%3A%20Load%20documents%20from%20MongoDB%0AMongodbLoader%20-%3E%20FastAPI%3A%20return%20documents%0A%0AFastAPI%20-%3E%20HuggingFaceEmbeddings%3A%20new%20HuggingFaceEmbeddings()%0AHuggingFaceEmbeddings%20-%3E%20FastAPI%3A%20return%20HuggingFaceEmbeddings%0A%0AFastAPI%20-%3E%20FAISS%3A%20FAISS.from_documents(data%2C%20embeddings)%0AFAISS%20-%3E%20FastAPI%3A%20return%20vectorstore%0A%0AFastAPI%20-%3E%20FAISS%3A%20vectorstore.as_retriever()%0AFAISS%20-%3E%20FastAPI%3A%20return%20retriever%0A%0AFastAPI%20-%3E%20FastAPI%3A%20Define%20prompt%20template%0A%0AFastAPI%20-%3E%20FastAPI%3A%20chain.invoke(item.chatQuestion)%0Anote%20right%20of%20FastAPI%3A%20context%20-%3E%20retriever%20-%3E%20format_docs%20-%3E%20prompt%20-%3E%20hf%20-%3E%20StrOutputParser%0A%0AFastAPI%20-%3E%20HuggingFacePipeline%3A%20hf.invoke()%0AHuggingFacePipeline%20-%3E%20FastAPI%3A%20return%20response%0A%0AFastAPI%20-%3E%20FastAPI%3A%20split_response%20%3D%20response.split('%20'%2C%201)%5B-1%5D%0A%0AFastAPI%20-%3E%20FastAPI%3A%20print(%22end%20processing%22)%0AFastAPI%20-%3E%20Client%3A%20return%20%7B%22chatResponse%22%3A%20split_response%7D%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1498" height="1235"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 95.73914152281817 L 44.631447682160164 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 95.73914152281817 L 347.161106026431 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 862.6491394306888 95.73914152281817 L 862.6491394306888 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1103.6492124647384 95.73914152281817 L 1103.6492124647384 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1260.5570434369688 95.73914152281817 L 1260.5570434369688 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1402.7977296338086 95.73914152281817 L 1402.7977296338086 1235.9363318628177" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.63409261281818 L 81.09529371432032 51.63409261281818 L 81.09529371432032 95.73914152281817 L 8.167601650000002 95.73914152281817 L 8.167601650000002 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.891297230500008" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 303.3672657926107 51.63409261281818 L 390.9549462602513 51.63409261281818 L 390.9549462602513 95.73914152281817 L 303.3672657926107 95.73914152281817 L 303.3672657926107 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="321.0909613731107" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">FastAPI</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 791.5360548121029 51.63409261281818 L 933.7622240492748 51.63409261281818 L 933.7622240492748 95.73914152281817 L 791.5360548121029 95.73914152281817 L 791.5360548121029 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="809.2597503926029" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">MongodbLoader</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1001.5769374775001 51.63409261281818 L 1205.7214874519766 51.63409261281818 L 1205.7214874519766 95.73914152281817 L 1001.5769374775001 95.73914152281817 L 1001.5769374775001 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1019.3006330580001" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HuggingFaceEmbeddings</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1222.0566907519767 51.63409261281818 L 1299.0573961219611 51.63409261281818 L 1299.0573961219611 95.73914152281817 L 1222.0566907519767 95.73914152281817 L 1222.0566907519767 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1239.7803863324766" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">FAISS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1315.392599421961 51.63409261281818 L 1490.2028598456563 51.63409261281818 L 1490.2028598456563 95.73914152281817 L 1315.392599421961 95.73914152281817 L 1315.392599421961 51.63409261281818 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1333.116295002461" y="79.40393822281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">HuggingFacePipeline</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16pt" font-style="normal" font-weight="normal" text-decoration="normal" x="578.8600997924805" y="24.651306798181814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Chatbot Service Sequence Diagram</text></g><g><rect fill="white" stroke="none" x="159.6378374847839" y="128.4095481228182" width="72.51687873902344" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="162.08811797978387" y="143.1112310928182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST /v1/</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 44.631447682160164 149.64531241281819 L 333.71178864276436 149.64531241281819" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,149.64531241281819) translate(-347.161106026431,-149.64531241281819)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 333.54843660976434 142.83897770448485 L 347.161106026431 149.64531241281819 L 333.54843660976434 156.45164712115152 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 192.93360115781817 L 355.328707676431 192.93360115781817 M 355.328707676431 174.1481173628182 L 537.9403314952591 174.1481173628182 L 552.6420144652591 188.8498003328182 L 552.6420144652591 211.71908495281818 L 355.328707676431 211.71908495281818 L 355.328707676431 174.1481173628182 M 537.9403314952591 174.1481173628182 L 537.9403314952591 188.8498003328182 L 552.6420144652591 188.8498003328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="378.19799229643104" y="197.01740198281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Receives chat question</text></g><g><rect fill="white" stroke="none" x="366.49109659809767" y="236.2218899028182" width="140.77736152710938" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="368.9413770930977" y="250.92357287281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">print("processing ...")</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 257.45765419281815 L 412.501919226431 257.45765419281815 L 412.501919226431 278.6934184828182 L 360.61042341009767 278.6934184828182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,278.6934184828182) translate(-347.161106026431,-278.6934184828182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 271.88708377448484 L 347.161106026431 278.6934184828182 L 360.7737754430977 285.4997531911515 Z"/></g></g><g><rect fill="white" stroke="none" x="579.6381079195951" y="303.19622343281816" width="50.53402961792969" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="582.0883884145951" y="317.89790640281814" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">aload()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 324.4319877228182 L 849.1998220470222 324.4319877228182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(862.6491394306888,324.4319877228182) translate(-862.6491394306888,-324.4319877228182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 849.0364700140221 317.62565301448484 L 862.6491394306888 324.4319877228182 L 849.0364700140221 331.2383224311515 Z"/></g></g><g><rect fill="white" stroke="none" x="881.9791300023555" y="348.9347926728182" width="215.95276130738281" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="884.4294104973555" y="363.6364756428182" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Load documents from MongoDB</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 862.6491394306888 370.1705569628182 L 927.9899526306888 370.1705569628182 L 927.9899526306888 391.4063212528182 L 876.0984568143555 391.4063212528182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(862.6491394306888,391.4063212528182) translate(-862.6491394306888,-391.4063212528182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 876.2618088473555 384.59998654448486 L 862.6491394306888 391.4063212528182 L 876.2618088473555 398.21265596115154 Z"/></g></g><g><rect fill="white" stroke="none" x="545.4147802828763" y="415.9091262028182" width="118.98068489136719" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8650607778764" y="430.61080917281816" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return documents</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 862.6491394306888 437.1448904928182 L 360.61042341009767 437.1448904928182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,437.1448904928182) translate(-347.161106026431,-437.1448904928182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 430.33855578448487 L 347.161106026431 437.1448904928182 L 360.7737754430977 443.95122520115154 Z"/></g></g><g><rect fill="white" stroke="none" x="618.2412404449205" y="461.6476954428182" width="214.32783760132813" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="620.6915209399206" y="476.34937841281817" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">new HuggingFaceEmbeddings()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 482.8834597328182 L 1090.1998950810716 482.8834597328182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1103.6492124647384,482.8834597328182) translate(-1103.6492124647384,-482.8834597328182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1090.0365430480717 476.07712502448487 L 1103.6492124647384 482.8834597328182 L 1090.0365430480717 489.68979444115155 Z"/></g></g><g><rect fill="white" stroke="none" x="617.4216298492174" y="507.38626468281814" width="215.96705879273438" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="619.8719103442174" y="522.0879476528181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return HuggingFaceEmbeddings</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1103.6492124647384 528.6220289728182 L 360.61042341009767 528.6220289728182" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,528.6220289728182) translate(-347.161106026431,-528.6220289728182)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 521.8156942644848 L 347.161106026431 528.6220289728182 L 360.7737754430977 535.4283636811515 Z"/></g></g><g><rect fill="white" stroke="none" x="660.8469274764459" y="553.1248339228181" width="286.0242792517187" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="663.2972079714459" y="567.8265168928181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">FAISS.from_documents(data, embeddings)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 574.3605982128181 L 1247.107726053302 574.3605982128181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1260.5570434369688,574.3605982128181) translate(-1260.5570434369688,-574.3605982128181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1246.9443740203021 567.5542635044848 L 1260.5570434369688 574.3605982128181 L 1246.9443740203021 581.1669329211514 Z"/></g></g><g><rect fill="white" stroke="none" x="743.9678838973443" y="598.863403162818" width="119.78238166871094" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="746.4181643923444" y="613.565086132818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return vectorstore</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1260.5570434369688 620.099167452818 L 360.61042341009767 620.099167452818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,620.099167452818) translate(-347.161106026431,-620.099167452818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 613.2928327444847 L 347.161106026431 620.099167452818 L 360.7737754430977 626.9055021611514 Z"/></g></g><g><rect fill="white" stroke="none" x="719.5334051375787" y="644.601972402818" width="168.6513391882422" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="721.9836856325787" y="659.303655372818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">vectorstore.as_retriever()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 665.837736692818 L 1247.107726053302 665.837736692818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1260.5570434369688,665.837736692818) translate(-1260.5570434369688,-665.837736692818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1246.9443740203021 659.0314019844847 L 1260.5570434369688 665.837736692818 L 1246.9443740203021 672.6440714011513 Z"/></g></g><g><rect fill="white" stroke="none" x="753.3415411239068" y="690.3405416428179" width="101.03506721558594" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="755.7918216189069" y="705.0422246128179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return retriever</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1260.5570434369688 711.576305932818 L 360.61042341009767 711.576305932818" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,711.576305932818) translate(-347.161106026431,-711.576305932818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 704.7699712244846 L 347.161106026431 711.576305932818 L 360.7737754430977 718.3826406411513 Z"/></g></g><g><rect fill="white" stroke="none" x="366.49109659809767" y="736.0791108828179" width="157.27704109253906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="368.9413770930977" y="750.7807938528179" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Define prompt template</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 757.3148751728179 L 412.501919226431 757.3148751728179 L 412.501919226431 778.5506394628179 L 360.61042341009767 778.5506394628179" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,778.5506394628179) translate(-347.161106026431,-778.5506394628179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 771.7443047544846 L 347.161106026431 778.5506394628179 L 360.7737754430977 785.3569741711513 Z"/></g></g><g><rect fill="white" stroke="none" x="366.49109659809767" y="803.0534444128178" width="214.31349433960938" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="368.9413770930977" y="817.7551273828178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">chain.invoke(item.chatQuestion)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 824.2892087028179 L 412.501919226431 824.2892087028179 L 412.501919226431 845.5249729928179 L 360.61042341009767 845.5249729928179" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,845.5249729928179) translate(-347.161106026431,-845.5249729928179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 838.7186382844845 L 347.161106026431 845.5249729928179 L 360.7737754430977 852.3313077011512 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 888.8132617378179 L 355.328707676431 888.8132617378179 M 355.328707676431 870.0277779428179 L 839.7798548106889 870.0277779428179 L 854.4815377806889 884.7294609128179 L 854.4815377806889 907.5987455328179 L 355.328707676431 907.5987455328179 L 355.328707676431 870.0277779428179 M 839.7798548106889 870.0277779428179 L 839.7798548106889 884.7294609128179 L 854.4815377806889 884.7294609128179" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="378.19799229643104" y="892.897062562818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">context -&gt; retriever -&gt; format_docs -&gt; prompt -&gt; hf -&gt; StrOutputParser</text></g><g><rect fill="white" stroke="none" x="838.3094031432252" y="932.1015504828179" width="73.34002937378906" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="840.7596836382252" y="946.8032334528178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hf.invoke()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 953.3373147728179 L 1389.3484122501418 953.3373147728179" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1402.7977296338086,953.3373147728179) translate(-1402.7977296338086,-953.3373147728179)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1389.1850602171419 946.5309800644845 L 1402.7977296338086 953.3373147728179 L 1389.1850602171419 960.1436494811512 Z"/></g></g><g><rect fill="white" stroke="none" x="821.1905829527955" y="977.8401197228178" width="107.57766975464844" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="823.6408634477955" y="992.5418026928178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return response</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1402.7977296338086 999.0758840128178 L 360.61042341009767 999.0758840128178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,999.0758840128178) translate(-347.161106026431,-999.0758840128178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 992.2695493044845 L 347.161106026431 999.0758840128178 L 360.7737754430977 1005.8822187211512 Z"/></g></g><g><rect fill="white" stroke="none" x="366.49109659809767" y="1023.5786889628179" width="263.50456489625" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="368.9413770930977" y="1038.2803719328178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">split_response = response.split(' ', 1)[-1]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 1044.8144532528179 L 412.501919226431 1044.8144532528179 L 412.501919226431 1066.0502175428178 L 360.61042341009767 1066.0502175428178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,1066.0502175428178) translate(-347.161106026431,-1066.0502175428178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 1059.2438828344846 L 347.161106026431 1066.0502175428178 L 360.7737754430977 1072.856552251151 Z"/></g></g><g><rect fill="white" stroke="none" x="366.49109659809767" y="1090.5530224928177" width="153.0178705603125" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="368.9413770930977" y="1105.2547054628178" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">print("end processing")</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 1111.7887867828179 L 412.501919226431 1111.7887867828179 L 412.501919226431 1133.0245510728178 L 360.61042341009767 1133.0245510728178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(347.161106026431,1133.0245510728178) translate(-347.161106026431,-1133.0245510728178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 360.7737754430977 1126.2182163644845 L 347.161106026431 1133.0245510728178 L 360.7737754430977 1139.830885781151 Z"/></g></g><g><rect fill="white" stroke="none" x="63.96143825382684" y="1157.527356022818" width="263.8696772009375" height="21.23576429"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.41171874882684" y="1172.229038992818" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return {"chatResponse": split_response}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 347.161106026431 1178.7631203128178 L 58.08076506582683 1178.7631203128178" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(44.631447682160164,1178.7631203128178) translate(-44.631447682160164,-1178.7631203128178)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 58.244117098826834 1171.9567856044846 L 44.631447682160164 1178.7631203128178 L 58.244117098826834 1185.569455021151 Z"/></g></g></g><g/><g/><g/><g/><g/><g/></g></svg>